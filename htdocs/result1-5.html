<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Business Frontpage - Start Bootstrap Template</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
    .button
    {
        display: inline-block;
        white-space: nowrap;
        background-color: #ddd;
        background-image: -webkit-gradient(linear, left top, left bottom, from(#eee), to(#ccc));
        background-image: -webkit-linear-gradient(top, #eee, #ccc);
        background-image: -moz-linear-gradient(top, #eee, #ccc);
        background-image: -ms-linear-gradient(top, #eee, #ccc);
        background-image: -o-linear-gradient(top, #eee, #ccc);
        background-image: linear-gradient(top, #eee, #ccc);
        border: 1px solid #777;
        padding: 0 1.5em;
        margin: 0.5em;
        font: bold 1em/2em Arial, Helvetica;
        text-decoration: none;
        color: #333;
        text-shadow: 0 1px 0 rgba(255,255,255,.8);
        -moz-border-radius: .2em;
        -webkit-border-radius: .2em;
        border-radius: .2em;
        -moz-box-shadow: 0 0 1px 1px rgba(255,255,255,.8) inset, 0 1px 0 rgba(0,0,0,.3);
        -webkit-box-shadow: 0 0 1px 1px rgba(255,255,255,.8) inset, 0 1px 0 rgba(0,0,0,.3);
        box-shadow: 0 0 1px 1px rgba(255,255,255,.8) inset, 0 1px 0 rgba(0,0,0,.3);
    }

    .button:hover
    {
        background-color: #eee;
        background-image: -webkit-gradient(linear, left top, left bottom, from(#fafafa), to(#ddd));
        background-image: -webkit-linear-gradient(top, #fafafa, #ddd);
        background-image: -moz-linear-gradient(top, #fafafa, #ddd);
        background-image: -ms-linear-gradient(top, #fafafa, #ddd);
        background-image: -o-linear-gradient(top, #fafafa, #ddd);
        background-image: linear-gradient(top, #fafafa, #ddd);
    }

    .button:active
    {
        -moz-box-shadow: 0 0 4px 2px rgba(0,0,0,.3) inset;
        -webkit-box-shadow: 0 0 4px 2px rgba(0,0,0,.3) inset;
        box-shadow: 0 0 4px 2px rgba(0,0,0,.3) inset;
        position: relative;
        top: 1px;
    }

    .button:focus
    {
        outline: 0;
        background: #fafafa;
    }

    .button:before
    {
        background: #ccc;
        background: rgba(0,0,0,.1);
        width: 1em;
        text-align: center;
        font-size: 1.3em;
        margin: 0 1em 0 -1em;
        padding: 0 .2em;
        -moz-box-shadow: 1px 0 0 rgba(0,0,0,.5), 2px 0 0 rgba(255,255,255,.5);
        -webkit-box-shadow: 1px 0 0 rgba(0,0,0,.5), 2px 0 0 rgba(255,255,255,.5);
        box-shadow: 1px 0 0 rgba(0,0,0,.5), 2px 0 0 rgba(255,255,255,.5);
        -moz-border-radius: .15em 0 0 .15em;
        -webkit-border-radius: .15em 0 0 .15em;
        border-radius: .15em 0 0 .15em;
        pointer-events: none;
    }

    /* Buttons and inputs */

    button.button, input.button
    {
    cursor: pointer;
    overflow: visible; /* removes extra side spacing in IE */
    }

    /* removes extra inner spacing in Firefox */
    button::-moz-focus-inner
    {
    border: 0;
    padding: 0;
    }

    /* If line-height can't be modified, then fix Firefox spacing with padding */
    input::-moz-focus-inner
    {
    padding: .4em;
    }

    /* The disabled styles */
    .button[disabled], .button[disabled]:hover, .button.disabled, .button.disabled:hover
    {
    background: #eee;
    color: #aaa;
    border-color: #aaa;
    cursor: default;
    text-shadow: none;
    position: static;
    -moz-box-shadow: none;
    -webkit-box-shadow: none;
    box-shadow: none;
    }

    /* Hexadecimal entities for the icons */

    .test:before
    {
        content: "\271A";
    }

    .next:before
    {
        content: "\279C";
    }


    /* Social media buttons */
    .fb,
    .fb:hover
    {
        background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(255,255,255,.5)), to(rgba(255,255,255,0)));
        background-image: -webkit-linear-gradient(top, rgba(255,255,255,.5), rgba(255,255,255,0));
        background-image: -moz-linear-gradient(top, rgba(255,255,255,.5), rgba(255,255,255,0));
        background-image: -ms-linear-gradient(top, rgba(255,255,255,.5), rgba(255,255,255,0));
        background-image: -o-linear-gradient(top, rgba(255,255,255,.5), rgba(255,255,255,0));
        background-image: linear-gradient(top, rgba(255,255,255,.5), rgba(255,255,255,0));
    }


    .fb, .fb:focus
    {
    background-color: #3C5A98;
    color: #fff;
    text-shadow: 0 1px 0 rgba(0,0,0,.4);
    }

    .fb:hover
    {
    background-color: #879bc3;
    }

    .fb:before
    {
    content: "f";
    background: #4467ac;
    background: rgba(0,0,0,.1);
    color: #fff;
    text-shadow: 0 1px 0 rgba(0,0,0,.4);
    }

    </style>
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#" onclick = "location.href = 'webmain.html' ">Tonymony</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Image Background Page Header -->
    <!-- Note: The background image is set within the business-casual.css file. -->
    <header class="business-header">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">

                </div>
            </div>
        </div>
    </header>

    <!-- Page Content -->
    <div class="container">

        <hr>


                <div class="row">
                      <img src="img/Temp2.png" alt="">
                </div>


        <div class="row">
            <div class="col-sm-8">
              <h1>최종 톤-타입(퍼스널 컬러) : 여름쿨톤 타입</h1>
                <p>
                </p>
            </div>
        </div>
        <!-- /.row -->

        <hr>

        <div class = "row">
          <div class = "col-md-5">
            <div id="columnchart_values" style="width: 500px; height: 360px;"></div>
          </div>
          <div class = "col-md-2">
            <h3>측정된 피부색</h3>
            <canvas id="myCanvas" style="width: 200px; height: 270px;">
          </div>
          <div class = "col-md-5">
            <img src="img/scoolcele.png" alt="">
          </div>
        </div>

        <div class="row">
              <h3>여름 계열의 화이트와 블루 색상 혹은 파스텔 계열 색상이 어울립니다.</h3>
              <h3>그리고 그레이 컬러도 어울립니다.</h3>
              <h3>특히 맑은 여름의 pale톤은 본인의 시크한 이미지에 잘 맞습니다.</h3>
              <h3>어울리지 않는 색상은 원색, 탁하고 짙은 색, 카키, 버건디 색상입니다.</h3>

        </div>

        <hr>

        <div class-"row">
          <div class="col-md-5">
          </div>
          <div class="col-md-7">
              <a class="button" onclick = submit() style="font-size:20pt;margin-top: 0px;padding-left: 10px;
              prdding-right: 10px; height: 57px; padding-right: 10px;">
              <img src="img/cosmetic.png">화장품 추천 받기</a>
          </div>

        </div>

        <!-- /.row -->

        <hr>

        <div class="row">
              <img src="img/Temp2.png" alt="">
        </div>
        <!-- Footer -->
        <footer>
            <div class="row">
                <div class="col-lg-12">
                    <p>Copyright &copy; 아주대학교 소프트웨어학과 캡스톤디자인 2017</p>
                </div>
            </div>
            <!-- /.row -->
        </footer>

    </div>
    <!-- /.container -->

</body>

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">

    var response;
    var xhr = new XMLHttpRequest();


  function lab2rgb(lab){
    var y = (lab[0] + 16) / 116,
        x = lab[1] / 500 + y,
        z = y - lab[2] / 200,
        r, g, b;

    x = 0.95047 * ((x * x * x > 0.008856) ? x * x * x : (x - 16/116) / 7.787);
    y = 1.00000 * ((y * y * y > 0.008856) ? y * y * y : (y - 16/116) / 7.787);
    z = 1.08883 * ((z * z * z > 0.008856) ? z * z * z : (z - 16/116) / 7.787);

    r = x *  3.2406 + y * -1.5372 + z * -0.4986;
    g = x * -0.9689 + y *  1.8758 + z *  0.0415;
    b = x *  0.0557 + y * -0.2040 + z *  1.0570;

    r = (r > 0.0031308) ? (1.055 * Math.pow(r, 1/2.4) - 0.055) : 12.92 * r;
    g = (g > 0.0031308) ? (1.055 * Math.pow(g, 1/2.4) - 0.055) : 12.92 * g;
    b = (b > 0.0031308) ? (1.055 * Math.pow(b, 1/2.4) - 0.055) : 12.92 * b;

    return [parseInt(Math.max(0, Math.min(1, r)) * 255),
            parseInt(Math.max(0, Math.min(1, g)) * 255),
            parseInt(Math.max(0, Math.min(1, b)) * 255)]
}


xhr.onload = function(){

  response=xhr.responseText;
  var lab=response.split('/');

  console.log(lab);

  var RGB_value=lab2rgb(lab);
  console.log(RGB_value);
  var str="rgb("+RGB_value[0]+", "+RGB_value[1]+", "+RGB_value[2]+")";
  var skin_color=colorToHex(str);

  var c = document.getElementById("myCanvas");
  var ctx = c.getContext("2d");
  ctx.fillStyle = skin_color;
  ctx.fillRect(20, 20, 150, 100);

  var L_value=[lab[0]];
  L_value.push('0');
  L_value.push('0');

  var l_color=lab2rgb(L_value);
  var str2="rgb("+l_color[0]+", "+l_color[1]+", "+l_color[2]+")";
  var l_result=colorToHex(str2);

  var A_value=[lab[0]];
  A_value.push(lab[1]);
  A_value.push('0');

  var A_color=lab2rgb(A_value);
  var str3="rgb("+A_color[0]+", "+A_color[1]+", "+A_color[2]+")";
  var a_result=colorToHex(str3);

  var B_value=[lab[0]];
  B_value.push('0');
  B_value.push(lab[2]);

  var B_color=lab2rgb(B_value);
  var str4="rgb("+B_color[0]+", "+B_color[1]+", "+B_color[2]+")";
  var b_result=colorToHex(str4);


  google.charts.load("current", {packages:['corechart']});
  google.charts.setOnLoadCallback(drawChart);
  function drawChart() {
    var data = google.visualization.arrayToDataTable([
      ["Element", "Value", { role: "style" } ],
      ["L(밝기)", 8.94, l_result],
      ["A(빨강/초록)", 10.49, a_result],
      ["B(노랑/파)", 19.30, b_result],

    ]);

    var view = new google.visualization.DataView(data);
    view.setColumns([0, 1,
                     { calc: "stringify",
                       sourceColumn: 1,
                       type: "string",
                       role: "annotation" },
                     2]);

    var options = {
      title: "사용자 피부색 측정 LAB 값",
      bar: {groupWidth: "75%"},
      legend: { position: "none" },
    };
    var chart = new google.visualization.ColumnChart(document.getElementById("columnchart_values"));
    chart.draw(view, options);
}





};

xhr.open("POST", "https://tonymony.com/page/8")
xhr.send();

function colorToHex(color) {
    if (color.substr(0, 1) === '#') {
        return color;
    }
    var digits = /(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(color);

    var red = parseInt(digits[2]);
    var green = parseInt(digits[3]);
    var blue = parseInt(digits[4]);

    var rgb = blue | (green << 8) | (red << 16);
    return digits[1] + '#' + rgb.toString(16);
};






function submit(){
  location.href = 'result2-2.html'
}

</script>
</html>
